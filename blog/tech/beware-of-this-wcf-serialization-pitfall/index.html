<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=en-us lang=en-us>
<head>
<link href=https://gmpg.org/xfn/11 rel=profile>
<meta http-equiv=x-ua-compatible content="chrome=1">
<meta charset=utf-8>
<meta name=robots content="index,follow">
<meta name=apple-mobile-web-app-title content="Aashish Koirala">
<meta name=application-name content="Aashish Koirala">
<meta name=msapplication-TileColor content="#00aba9">
<meta name=theme-color content="#ffffff">
<meta charset=utf-8>
<meta name=generator content="Hugo 0.87.0">
<meta name=viewport content="width=device-width,initial-scale=1">
<title>Beware of this WCF Serialization Pitfall &#183; Aashish Koirala</title>
<meta name=description content>
<link type=text/css rel=stylesheet href=https://aashishkoirala.com/css/print.css media=print>
<link type=text/css rel=stylesheet href=https://aashishkoirala.com/css/poole.css>
<link type=text/css rel=stylesheet href=https://aashishkoirala.com/css/syntax.css>
<link type=text/css rel=stylesheet href=https://aashishkoirala.com/css/hyde.css>
<link rel=stylesheet href="https://fonts.googleapis.com/css?family=Abril+Fatface|PT+Sans:400,400i,700">
<link rel=apple-touch-icon-precomposed sizes=144x144 href=https://aashishkoirala.com/apple-touch-icon.png>
<link rel=apple-touch-icon sizes=180x180 href=https://aashishkoirala.com/apple-touch-icon.png>
<link rel="shortcut icon" href=https://aashishkoirala.com/favicon-16x16.png>
<link rel=icon type=image/png sizes=32x32 href=https://aashishkoirala.com/favicon-32x32.png>
<link rel=icon type=image/png sizes=16x16 href=https://aashishkoirala.com/favicon-16x16.png>
<link rel=manifest href=https://aashishkoirala.com/site.webmanifest>
<link rel=mask-icon href=https://aashishkoirala.com/favicon-safari-pinned-tab.svg color=#5bbad5>
<meta property="og:title" content="Beware of this WCF Serialization Pitfall">
<meta property="og:description" content="Ideally, one should avoid data contracts with complex graphs- especially with repeated references and definitely ones with circular references. Those can make your payload explode on serialization. With repeated references, you may run into an integrity issue on deserialization. With circular references, the serialization will enter a recursive loop and you will probably run into a stack overflow.
Seeing that in certain situations, this becomes unavoidable, WCF has a way that you can tell it to preserve object references during serialization.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://aashishkoirala.com/blog/tech/beware-of-this-wcf-serialization-pitfall/"><meta property="og:image" content="https://aashishkoirala.com/logo.png"><meta property="article:section" content="blog">
<meta property="article:published_time" content="2014-12-02T00:00:00+00:00">
<meta property="article:modified_time" content="2014-12-02T00:00:00+00:00">
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="https://aashishkoirala.com/logo.png">
<meta name=twitter:title content="Beware of this WCF Serialization Pitfall">
<meta name=twitter:description content="Ideally, one should avoid data contracts with complex graphs- especially with repeated references and definitely ones with circular references. Those can make your payload explode on serialization. With repeated references, you may run into an integrity issue on deserialization. With circular references, the serialization will enter a recursive loop and you will probably run into a stack overflow.
Seeing that in certain situations, this becomes unavoidable, WCF has a way that you can tell it to preserve object references during serialization.">
</head>
<body class=theme-base-0d>
<aside class=sidebar>
<div class="container sidebar-sticky">
<div class=sidebar-about>
<a href=https://aashishkoirala.com/>
<img src=https://aashishkoirala.com/logo.png alt="Aashish Koirala Software Developer. Overthinker.">
<h1>aashish<b>koirala</b></h1>
</a>
<p class=lead>Software Developer. Overthinker.</p>
</div>
<nav>
<ul class=sidebar-nav>
<li><a href=https://aashishkoirala.com/>Home</a> </li>
<li><a href=/about> About Me </a></li><li><a href=https://github.com/aashishkoirala/> Github </a></li><li><a href=https://twitter.com/aashishkoirala/> Twitter </a></li><li><a href=https://www.linkedin.com/in/aashishkoirala/> LinkedIn </a></li><li><a href=/blog/tech> Blog Posts - Tech </a></li><li><a href=/blog/nontech> Blog Posts - Non-Tech </a></li><li><a href=/index.xml> Subscribe (RSS) </a></li>
</ul>
</nav>
<p>&copy; 2021. All rights reserved. </p>
</div>
</aside>
<main class="content container">
<div class=post>
<h1>Beware of this WCF Serialization Pitfall</h1>
<time datetime=2014-12-02T00:00:00Z class=post-date>Tue, Dec 2, 2014</time>
<p>Ideally, one should avoid data contracts with complex graphs- especially with repeated references and definitely ones with circular references. Those can make your payload explode on serialization. With repeated references, you may run into an integrity issue on deserialization. With circular references, the serialization will enter a recursive loop and you will probably run into a stack overflow.</p>
<p>Seeing that in certain situations, this becomes unavoidable, WCF has <a href="https://msdn.microsoft.com/en-us/library/system.runtime.serialization.datacontractattribute.isreference(v=vs.110).aspx">a way</a> that you can tell it to preserve object references during serialization. You do this by setting <em>IsReference</em> to <strong>true</strong> on the <em>DataContract</em> attribute that you use to decorate the composite type that is your data contract.</p>
<p>So, for example:</p>
<pre><code>[DataContract(IsReference = true)]
public class MyContract
{
   [DataMember]
   public string Member1 { get; set; }
   ...
   ...
}
</code></pre>
<p>This solves the problem- however, since WCF achieves this by augmenting the WSDL- beware of this when you are exposing your service to third parties (especially ones that are not using WCF or perhaps not .NET at all) and interoperability is a concern. Without <em>IsReference</em> set to <strong>true</strong>, the WSDL snippet for the above would look something like:</p>
<pre><code>&lt;xs:complexType name=&quot;MyContract&quot;&gt;
  &lt;xs:sequence&gt;
	&lt;xs:element minOccurs=&quot;0&quot; name=&quot;Member1&quot; nillable=&quot;true&quot; type=&quot;xs:string&quot;/&gt;
	...
  &lt;/xs:sequence&gt;
&lt;/xs:complexType&gt;
</code></pre>
<p>With <em>IsReference</em> set to <strong>true</strong>, this is what it looks like:</p>
<pre><code>&lt;xs:complexType name=&quot;MyContract&quot;&gt;
  &lt;xs:sequence&gt;
	&lt;xs:element minOccurs=&quot;0&quot; name=&quot;Member1&quot; nillable=&quot;true&quot; type=&quot;xs:string&quot;/&gt;
	...
  &lt;/xs:sequence&gt;
  **&lt;xs:attribute ref=&quot;ser:Id&quot;/&gt;**
 **&lt;xs:attribute ref=&quot;ser:Ref&quot;/&gt;**
&lt;/xs:complexType&gt;
</code></pre>
<p>See those two lines that got added (i.e. &ldquo;Id&rdquo; and &ldquo;Ref&rdquo;)? That could very well cause some other party&rsquo;s WSDL parser/proxy generator to choke. You have been warned.</p>
<div style=font-size:smaller>
<br><br>
Tags:
<a href=https://aashishkoirala.com/tags/csharp/>csharp</a> <a href=https://aashishkoirala.com/tags/dotnet/>dotnet</a> <a href=https://aashishkoirala.com/tags/wcf/>wcf</a>
<br>Previous:
<a href=https://aashishkoirala.com/blog/tech/using-css-media-queries-for-responsive-ui-design/>Using CSS Media Queries for Responsive UI Design</a>
<br>Next:
<a href=https://aashishkoirala.com/blog/tech/git-rewriter-of-history/>Git- Rewriter of History</a>
</div>
</div>
<h2>Comments</h2>
<div id=disqus_thread></div>
<script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return}var b=document,a=b.createElement('script');a.async=!0,a.src='//aashishkoirala.disqus.com/embed.js',a.setAttribute('data-timestamp',+new Date),(b.head||b.body).appendChild(a)})()</script>
<noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript>
<a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a>
</main>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-1VD1W7LBR1"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-1VD1W7LBR1',{anonymize_ip:!1})}</script>
</body>
</html>